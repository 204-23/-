<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥ç¨‹æ•¸å­¸è¨ˆç®—æ©Ÿ V3 (çµ‚æ¥µç‰ˆ)</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/algebrite@1.4.0/dist/algebrite.bundle-min.js"></script>

    <style>
        body { font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; padding: 20px; background-color: #f0f2f5; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 30px; }
        
        /* å€å¡Šæ¨£å¼ */
        section { margin-bottom: 40px; padding: 20px; background: #fff; border: 1px solid #e1e4e8; border-radius: 10px; }
        section:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-color: #3498db; transition: 0.3s; }
        
        h2 { color: #2980b9; border-left: 5px solid #2980b9; padding-left: 10px; margin-top: 0; }
        .note { font-size: 0.9em; color: #7f8c8d; margin-bottom: 10px; background: #f8f9fa; padding: 8px; border-radius: 5px; }
        
        /* è¼¸å…¥æ¡†èˆ‡æŒ‰éˆ• */
        input { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #dfe6e9; border-radius: 8px; font-size: 16px; font-family: monospace; box-sizing: border-box; }
        input:focus { border-color: #3498db; outline: none; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        button { flex: 1; padding: 12px; border: none; cursor: pointer; border-radius: 8px; font-size: 16px; font-weight: bold; color: white; transition: 0.2s; }
        button:hover { opacity: 0.9; transform: translateY(-2px); }

        /* å„ç¨®æŒ‰éˆ•é¡è‰² */
        .btn-blue { background-color: #3498db; }
        .btn-green { background-color: #27ae60; } /* ç©åˆ†å°ˆç”¨ */
        .btn-orange { background-color: #e67e22; }
        .btn-red { background-color: #e74c3c; }
        .btn-purple { background-color: #9b59b6; }

        .result { margin-top: 15px; padding: 15px; background-color: #ecf0f1; border-radius: 8px; font-family: monospace; font-size: 1.2em; white-space: pre-wrap; color: #2c3e50; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“ å·¥ç¨‹æ•¸å­¸è¨ˆç®—æ©Ÿ V3</h1>

    <section>
        <h2>1. å¾®åˆ† (Derivative)</h2>
        <div class="note">è¼¸å…¥ç¯„ä¾‹: x^3 + 2x^2, sin(x)*cos(x)</div>
        <input type="text" id="deriv-input" value="x^3 + 2*x^2">
        <button class="btn-blue" style="width:100%" onclick="calcDeriv()">è¨ˆç®—å¾®åˆ† f'(x)</button>
        <div id="deriv-result" class="result">çµæœé¡¯ç¤ºå€</div>
    </section>

    <section>
        <h2>2. ä¸å®šç©åˆ† (Integral)</h2>
        <div class="note">è¼¸å…¥ç¯„ä¾‹: x^2, sin(x), 1/x (ä½¿ç”¨ Algebrite é‹ç®—)</div>
        <input type="text" id="integ-input" value="x^2 + sin(x)">
        <button class="btn-green" style="width:100%" onclick="calcIntegral()">è¨ˆç®—ç©åˆ† âˆ« f(x) dx</button>
        <div id="integ-result" class="result">çµæœé¡¯ç¤ºå€</div>
    </section>

    <section>
        <h2>3. çŸ©é™£å¤§å¸« (Matrix)</h2>
        <div class="note">è¼¸å…¥æ ¼å¼: [1, 2; 3, 4]</div>
        <input type="text" id="matrix-input" value="[1, 2; 3, 4]">
        <div class="btn-group">
            <button class="btn-orange" onclick="calcMatrix('det')">è¡Œåˆ—å¼</button>
            <button class="btn-red" onclick="calcMatrix('inv')">åçŸ©é™£</button>
            <button class="btn-purple" onclick="calcMatrix('trans')">è½‰ç½®</button>
        </div>
        <div id="matrix-result" class="result">çµæœé¡¯ç¤ºå€</div>
    </section>
</div>

<script>
    // 1. å¾®åˆ† (ä½¿ç”¨ math.js)
    function calcDeriv() {
        const expr = document.getElementById('deriv-input').value;
        try {
            const res = math.derivative(expr, 'x');
            document.getElementById('deriv-result').innerText = "f'(x) = " + res.toString();
        } catch (e) {
            document.getElementById('deriv-result').innerText = "âŒ æ ¼å¼éŒ¯èª¤: " + e.message;
        }
    }

    // 2. ç©åˆ† (ä½¿ç”¨ Algebrite)
    function calcIntegral() {
        const expr = document.getElementById('integ-input').value;
        const resDiv = document.getElementById('integ-result');
        try {
            // [é—œéµ] å‘¼å« Algebrite çš„ integral å‡½å¼
            // run å‡½å¼æœƒåŸ·è¡ŒæŒ‡ä»¤ï¼Œ'integral(æ–¹ç¨‹å¼)'
            const result = Algebrite.run(`integral(${expr})`);
            
            // Algebrite æœ‰æ™‚å€™æœƒè¼¸å‡ºå¾ˆé•·çš„çµæœï¼Œæˆ‘å€‘ç›´æ¥é¡¯ç¤º
            resDiv.innerText = "âˆ« f(x) dx = " + result + " + C";
        } catch (e) {
            resDiv.innerText = "âŒ è¨ˆç®—å¤±æ•—ï¼Œè«‹æª¢æŸ¥è¼¸å…¥æ ¼å¼";
        }
    }

    // 3. çŸ©é™£ (ä½¿ç”¨ math.js)
    function calcMatrix(action) {
        const input = document.getElementById('matrix-input').value;
        const resDiv = document.getElementById('matrix-result');
        try {
            const matrix = math.evaluate(input);
            let res = "";
            
            if (action === 'det') {
                res = "Det = " + math.det(matrix);
            } else if (action === 'inv') {
                res = "Inv =\n" + math.format(math.inv(matrix), {precision: 4});
            } else if (action === 'trans') {
                res = "Trans =\n" + math.format(math.transpose(matrix));
            }
            resDiv.innerText = res;
        } catch (e) {
            resDiv.innerText = "âŒ çŸ©é™£éŒ¯èª¤: æ ¼å¼ä¸å°æˆ–ç„¡åçŸ©é™£";
        }
    }
</script>

</body>
</html>
